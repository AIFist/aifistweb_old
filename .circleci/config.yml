version: 2.1
jobs:
  build:
    docker:
      - image: cimg/node:21.6.2
    steps:
      - checkout

      # Install Firebase tools
      - run:
          name: Install Firebase Tools
          command: npm install -g firebase-tools

      # Authenticate with Firebase using service account key
      - run:
          name: Authenticate with Firebase
          command: |
            echo $GOOGLE_APPLICATION_CREDENTIALS | base64 --decode > ${HOME}/gcp-key.json
            echo "ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAicGxhdGVkLW1vbm9saXRoLTI5MDcwOCIsCiAgInByaXZhdGVfa2V5X2lkIjogIjVmNjg5MGRiZDk1OGZjNzMxZjFiYzNhYWFlZDI4ZWM1NDc5NjM1MWYiLAogICJwcml2YXRlX2tleSI6ICItLS0tLUJFR0lOIFBSSVZBVEUgS0VZLS0tLS1cbk1JSUV1d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktVd2dnU2hBZ0VBQW9JQkFRQ3lHNVVzRDJodHZTREpcbnJXTWlBMUZXZmRDOFh2YllqMzB4YXVGNGpkU3JFRnpWcVZMcG12cHl2cWFBRHg4L1pSWEhZcnoycXA1YmpwaHdcbnRjT3FaN3NOM1AvT3FHTUFyNCtWdVR1ajdIMWZBY2s2UTQ5UDJBblZQUDdUUEdka0syK3FjbWVTU2RVK250U3Rcbjk1KzRNd2k3WjZoUDNkTUhVYTIzQ05nY3BrTi9hWEliT3RMU01MUWwvN3dkbWg4bGE4b05iY0ZyWGowbUZaclpcbnpjdUUxUnlGK2pzc0FiRStlTjZ0Wmc0VC9pdTV4QytQMDgvM3orWUFybTRCeXZGNzRxZDJGcXpyZXJkcWYzVi9cbk53SXo4OWRCQWdNQkFBRUNnZjg4Y04vT2Mrd2NVWEl1L29nRm90cVhYMXJXa2VOeTJqN0I1bU5kWmNRbHlRZTNcbitoNEk2RzdWUVoxL0Y2S2pBTXJEUHQ2aFZvVW16TjB1WW9Cajg0K214TGlLaU5vUUFZUFlhMk94M1M4dWJveTdcbkdQSXBSa2NQOWdNRDdCdXFBcE9DWkJDQnRFeUpVNTBZN0V0QlkwZmdCS013VlRsR3V5aWtKVkJjQ29lbUZ6d0pcblRGT05jRlo4RStoTEE5U2JZclB5YXQzaHNHenQ3TCtDZ1BRK3krdEx5cXlneFcvM3NpemRwVmZ5Z093RktrdHRcbll6c1VlaG5QTkI4RDQzenJNVFFuZVZnamp6aFVYOCtLMWRoVTZlckxGdnJ0UlNOMjBxUFZwQzdYc0JIR1pJXG5VdFlNNUVMaGJUYUpJWGFmc3FiMWQrNC91YmQreEx2Vzk5Yk5qUk16d2NZVVc4WHNvTjdjQ3FtNU84OHlvVlZcbjB6VmE2QWtDZ1lCQXBKQndSeENuSXIxY1hGdVZlekxpaTRGUWRBQlllTXYwczhNTE1JZEJCak9MSDhLdXlaeHFcbmM1UTU5VE90ZzdFWUx0SDluaXJzRWxNN3VrUmJZTzNjNGkzUTI2VkZybjFLeHRoeXd3Qzh1NlZmaDBSVER6aGJcbkg0QjRRSWl4TkZ3ZnNHNmtGcHZVUG9yM3dBNHp6M0NqRG9jdVExSFR6VDEweHY4MXhNUWVtUUtCZ1FDOFQ2OTNcbmhVbGg4V0t3WmhzaTBDSU9Ddmk4ak4wbldobFFqRDRlNXhJTVZ1R3NJckRyN2lESWNjbExxazdhYjRSdTcrTWtcbkFrVmt5c1NvRU44dWtRTWFOYnVqb1o0TG9LcG54UmZqQ0h0WkFJbUdlbnAwQTQ1TUFFcnhxNGlZZ2ovVDY5MWxcbk5UYWFQek5kOHEvbnkwaUY2djdobnFHOTZXa3V4QStWV0w3SFVRS0JnR1cvNVRvdGZBcnY2NUwwdHF3cFZsUzhcbnVPdUJmTFo2THRjbWZ3dS9TM0ZvRVlmWXpOS3BQaytuRDBzeXQwMFNsQXQxcDdHbkZVRjBLV3hKTTlvZ2pkN2VcbjhTaDh0RWlIVThPYldlRmNGZ1BPQkdteVNFVXBGRGk4NDRhS29sbTVEMDlLbEdQNGovNW4wN1BwK0ZSSndWMitcbk5lVWhuUE5COEQ0enJNUWNadUozXG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iLAogICJjbGllbnRfZW1haWwiOiAic2FsbWFuQHBsYXRlZC1tb25vbGl0aC0yOTA3MDguaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJjbGllbnRfaWQiOiAiMTEwNTU5MDMyNDA2Njg1NDczMDU1IiwKICAiYXV0aF91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLAogICJ0b2tlbl91cmkiOiAiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4iLAogICJhdXRoX3Byb3ZpZGVyX3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzIiwKICAiY2xpZW50X3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS9zYWxtYW4lNDBwbGF0ZWQtbW9ub2xpdGgtMjkwNzA4LmlhbS5nc2VydmljZWFjY291bnQuY29tIiwKICAidW5pdmVyc2VfZG9tYWluIjogImdvb2dsZWFwaXMuY29tIgp9Cg==" | base64 --decode > ${HOME}/gcp-key.json

            firebase deploy --only hosting --token ${HOME}/gcp-key.json

workflows:
  deploy_firebase_website:
    jobs:
      - build:
          filters:
            branches:
              only:
                - main


